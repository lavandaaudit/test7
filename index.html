<!DOCTYPE html>
<html lang="uk">
<head>
<meta charset="UTF-8">
<title>IBONARIUM ¬∑ SOLAR EVENTS ¬∑ LIVE</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
*{box-sizing:border-box}
html,body{
    margin:0;
    background:#000;
    color:#bfefff;
    font-family: Inter, system-ui, monospace;
}
header{
    padding:12px;
    text-align:center;
    border-bottom:1px solid #122;
    letter-spacing:2px;
}
#events{
    padding:10px;
    display:grid;
    gap:12px;
}
.event{
    border:1px solid #133;
    background:#02090d;
    padding:10px;
}
.time{color:#7ff}
.type{font-weight:bold}
.X{color:#ff4b4b}
.M{color:#ffb347}
.C{color:#7fff7f}
.coord{opacity:.8}
.instrument{opacity:.7;font-size:12px}
video,img{
    width:100%;
    margin-top:6px;
    border:1px solid #122;
}
footer{
    text-align:center;
    padding:8px;
    font-size:11px;
    opacity:.5;
}
</style>
</head>

<body>

<header>
IBONARIUM :: SOLAR EVENTS :: LIVE
</header>

<div id="events">–ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è‚Ä¶</div>

<footer>
Data: LMSAL HEK v2 ¬∑ auto update 5 min
</footer>

<script>
function iso(d){
    return d.toISOString().split(".")[0];
}

// –æ—Å—Ç–∞–Ω–Ω—ñ 72 –≥–æ–¥–∏–Ω–∏
const end = iso(new Date());
const start = iso(new Date(Date.now() - 72*3600*1000));

const API =
`https://www.lmsal.com/hek/api/v2/events` +
`?event_type=FL,ER,CME` +
`&startTime=${start}` +
`&endTime=${end}` +
`&limit=12`;

async function load(){
    try{
        const r = await fetch(API);
        const j = await r.json();

        const box = document.getElementById("events");
        box.innerHTML="";

        if(!j.events || j.events.length===0){
            box.innerHTML="–ù–µ–º–∞—î –ø–æ–¥—ñ–π –∑–∞ –ø–µ—Ä—ñ–æ–¥";
            return;
        }

        j.events.forEach(e=>{
            const div=document.createElement("div");
            div.className="event";

            const cls=e.goess_class || "";
            const clsType=cls.charAt(0);

            // –≤—ñ–¥–µ–æ –∞–±–æ fallback-–∞–Ω—ñ–º–∞—Ü—ñ—è
            let media="";
            if(e.event_movie_url){
                media=`<video controls src="${e.event_movie_url}"></video>`;
            } else if(e.preview_image){
                media=`<img src="${e.preview_image}" alt="preview">`;
            }

            div.innerHTML=`
                <div class="time">‚è± ${e.start_time}</div>
                <div class="type">
                    ‚òÄ ${e.event_type}
                    <span class="${clsType}">üî• ${cls}</span>
                </div>
                <div class="coord">
                    üìç X:${e.hpc_x ?? "?"} Y:${e.hpc_y ?? "?"}
                </div>
                <div class="instrument">
                    üõ∞ ${e.obs_instrument || "unknown"}
                </div>
                ${media}
            `;
            box.appendChild(div);
        });

    }catch(err){
        document.getElementById("events").innerText =
            "HEK v2 –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∏–π –∞–±–æ —Ç–∏–º—á–∞—Å–æ–≤–∏–π –∑–±—ñ–π";
        console.error(err);
    }
}

load();
setInterval(load,300000); // 5 —Ö–≤
</script>

</body>
</html>
