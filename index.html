<!DOCTYPE html>
<html lang="uk">
<head>
<meta charset="UTF-8">
<title>IBONARIUM ¬∑ SOLAR EVENTS ¬∑ LIVE</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
*{box-sizing:border-box}
html,body{
    margin:0;
    background:#000;
    color:#cfefff;
    font-family: Inter, system-ui, monospace;
}
header{
    padding:12px;
    text-align:center;
    border-bottom:1px solid #122;
    letter-spacing:2px;
}
#events{
    padding:10px;
    display:grid;
    gap:12px;
}
.event{
    border:1px solid #133;
    background:#02090d;
    padding:10px;
}
.time{color:#7ff}
.type{font-weight:bold}
.X{color:#ff4b4b}
.M{color:#ffb347}
.C{color:#7fff7f}
.coord{opacity:.8}
.instrument{opacity:.7;font-size:12px}
img{
    width:100%;
    margin-top:6px;
    border:1px solid #122;
}
a{color:#7ff;font-size:12px}
footer{
    text-align:center;
    padding:8px;
    font-size:11px;
    opacity:.5;
}
</style>
</head>

<body>

<header>
IBONARIUM :: SOLAR EVENTS :: LIVE
</header>

<div id="events">–ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è‚Ä¶</div>

<footer>
NASA DONKI ¬∑ SDO ¬∑ SOHO ¬∑ auto update
</footer>

<script>
const API_KEY = "DEMO_KEY";

function iso(d){
    return d.toISOString().split("T")[0];
}

const end = iso(new Date());
const start = iso(new Date(Date.now() - 7*24*3600*1000));

const FLARE_API =
`https://api.nasa.gov/DONKI/FLR?startDate=${start}&endDate=${end}&api_key=${API_KEY}`;

const CME_API =
`https://api.nasa.gov/DONKI/CME?startDate=${start}&endDate=${end}&api_key=${API_KEY}`;

async function load(){
    const box=document.getElementById("events");
    box.innerHTML="";

    try{
        const [flares,cmes]=await Promise.all([
            fetch(FLARE_API).then(r=>r.json()),
            fetch(CME_API).then(r=>r.json())
        ]);

        const events=[
            ...flares.map(e=>({...e,_type:"FL"})),
            ...cmes.map(e=>({...e,_type:"CME"}))
        ];

        events.sort((a,b)=>
            new Date(b.beginTime||b.startTime) -
            new Date(a.beginTime||a.startTime)
        );

        events.slice(0,10).forEach(e=>{
            const div=document.createElement("div");
            div.className="event";

            const cls=e.classType||"";
            const clsType=cls.charAt(0);

            const instruments = e.instruments
              ? e.instruments.map(i=>i.displayName).join(", ")
              : "NASA";

            let media = `
                <img src="https://sdo.gsfc.nasa.gov/assets/img/latest/latest_1024_0171.jpg">
                <img src="https://soho.nascom.nasa.gov/data/realtime/c2/1024/latest.jpg">
            `;

            if(e.link){
                media += `<a href="${e.link}" target="_blank">‚ñ∂ –æ—Ñ—ñ—Ü—ñ–π–Ω–∞ –∞–Ω—ñ–º–∞—Ü—ñ—è –ø–æ–¥—ñ—ó</a>`;
            }

            div.innerHTML=`
                <div class="time">‚è± ${e.beginTime || e.startTime}</div>
                <div class="type">
                    ‚òÄ ${e._type}
                    <span class="${clsType}">üî• ${cls}</span>
                </div>
                <div class="coord">üìç ${e.sourceLocation || "‚Äî"}</div>
                <div class="instrument">üõ∞ ${instruments}</div>
                ${media}
            `;
            box.appendChild(div);
        });

    }catch(err){
        box.innerText="–ü–æ–º–∏–ª–∫–∞ –æ—Ç—Ä–∏–º–∞–Ω–Ω—è –¥–∞–Ω–∏—Ö NASA";
        console.error(err);
    }
}

load();
setInterval(load,600000);
</script>

</body>
</html>
